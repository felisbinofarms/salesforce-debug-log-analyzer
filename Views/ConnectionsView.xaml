<UserControl x:Class="SalesforceDebugAnalyzer.Views.ConnectionsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             AllowDrop="True"
             PreviewDrop="DropZone_Drop"
             PreviewDragOver="DropZone_DragOver"
             PreviewDragLeave="DropZone_DragLeave">
    
    <UserControl.Resources>
        <!-- Discord Card Style -->
        <Style x:Key="GlassCard" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource BorderDefault}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1C1C30" Offset="0"/>
                        <GradientStop Color="#13131E" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#7C6AFF" Opacity="0.12" BlurRadius="24" ShadowDepth="0"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Feature Card Style -->
        <Style x:Key="FeatureCard" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource BorderDefault}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1A1A2E" Offset="0"/>
                        <GradientStop Color="#13131E" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#7C6AFF" Opacity="0.1" BlurRadius="16" ShadowDepth="0"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Hero Button Style -->
        <Style x:Key="HeroButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentPrimary}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="56"/>
            <Setter Property="Padding" Value="48,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentHover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentActive}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Secondary Button Style -->
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="Padding" Value="32,0"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderDefault}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource BgHover}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <Grid AllowDrop="True">
        <Grid.Background>
            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                <GradientStop Color="#0D0D16" Offset="0"/>
                <GradientStop Color="#13131E" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" AllowDrop="True">
            <Grid Margin="24,24,24,24" AllowDrop="True">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="24"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Hero Card -->
                <Border Grid.Row="0" Style="{StaticResource GlassCard}" 
                        Padding="32,48,32,48" HorizontalAlignment="Stretch" MaxWidth="800"
                        BorderThickness="0,2,0,0" BorderBrush="{StaticResource AccentPrimary}">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#1E1630" Offset="0"/>
                            <GradientStop Color="#13131E" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect Color="#7C6AFF" Opacity="0.3" BlurRadius="40" ShadowDepth="0"/>
                    </Border.Effect>
                    <StackPanel>
                    <!-- Logo & Title -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,24">
                        <Border CornerRadius="16" Width="72" Height="72" Margin="0,0,16,0">
                            <Border.Background>
                                <RadialGradientBrush>
                                    <GradientStop Color="#7B1010" Offset="0"/>
                                    <GradientStop Color="#2A0505" Offset="1"/>
                                </RadialGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="#F85149" Opacity="0.9" BlurRadius="22" ShadowDepth="0"/>
                            </Border.Effect>
                            <materialDesign:PackIcon Kind="Spider" Width="42" Height="42" 
                                                     Foreground="White" VerticalAlignment="Center" 
                                                     HorizontalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Black Widow" FontSize="38" FontWeight="Bold" LineHeight="46">
                                <TextBlock.Foreground>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="White" Offset="0"/>
                                        <GradientStop Color="#C4B5FF" Offset="1"/>
                                    </LinearGradientBrush>
                                </TextBlock.Foreground>
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Tagline -->
                    <TextBlock Text="Catch Every Bug in Your Web" 
                               FontSize="20" 
                               Foreground="{StaticResource TextSecondary}"
                               HorizontalAlignment="Center"
                               TextAlignment="Center"
                               Margin="0,0,0,8"
                               LineHeight="30"
                               FontWeight="SemiBold"/>
                    
                    <TextBlock Text="Trap bugs in your Salesforce logs. Hunt them down. No escape." 
                               FontSize="14" 
                               Foreground="{StaticResource TextMuted}"
                               HorizontalAlignment="Center"
                               TextAlignment="Center"
                               Margin="0,0,0,24"
                               LineHeight="24"
                               TextWrapping="Wrap"/>
                    
                    <!-- CTA Buttons -->
                    <StackPanel HorizontalAlignment="Stretch" MaxWidth="400">
                        <Button Content="Start Hunting 🕷️"
                                Style="{StaticResource HeroButton}"
                                Click="ConnectProduction_Click"
                                Margin="0,0,0,16">
                            <Button.Effect>
                                <DropShadowEffect BlurRadius="20" Color="#7C6AFF" Opacity="0.6" ShadowDepth="0"/>
                            </Button.Effect>
                        </Button>
                        
                        <Button Content="Connect to Sandbox"
                                Style="{StaticResource SecondaryButton}"
                                Click="ConnectSandbox_Click"
                                Margin="0,0,0,8"/>

                        <!-- Connection benefit hint -->
                        <TextBlock FontSize="12" HorizontalAlignment="Center" Margin="0,0,0,16"
                                   Foreground="{StaticResource TextMuted}" TextAlignment="Center">
                            <Run Text="✓ Connect to download logs, set up debug logging,"/>
                            <LineBreak/>
                            <Run Text="and stream logs live as you work in Salesforce"/>
                        </TextBlock>
                        
                        <!-- OR Divider -->
                        <Grid Margin="0,8,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Height="1" Background="{StaticResource BgInput}" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" Text="OR ANALYZE OFFLINE" Foreground="{StaticResource TextMuted}" 
                                       FontSize="11" FontWeight="SemiBold" Margin="12,0"/>
                            <Border Grid.Column="2" Height="1" Background="{StaticResource BgInput}" VerticalAlignment="Center"/>
                        </Grid>
                        
                        <!-- Drop Zone -->
                        <Border x:Name="DropZoneBorder"
                                Background="{StaticResource BgTertiary}" 
                                BorderBrush="{StaticResource AccentPrimary}" 
                                BorderThickness="2"
                                CornerRadius="8"
                                Padding="24"
                                Margin="0,0,0,16"
                                Cursor="Hand"
                                AllowDrop="True"
                                MouseLeftButtonUp="DropZone_Click">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{StaticResource BgTertiary}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <StackPanel HorizontalAlignment="Center" AllowDrop="True">
                                <materialDesign:PackIcon Kind="FileDocumentOutline" 
                                                         Width="36" Height="36" 
                                                         Foreground="{StaticResource AccentPrimary}"
                                                         HorizontalAlignment="Center"
                                                         Margin="0,0,0,8"
                                                         IsHitTestVisible="False"/>
                                <TextBlock x:Name="DropZoneText" 
                                           Text="Drop a folder or .log file here" 
                                           FontSize="14" 
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimary}"
                                           HorizontalAlignment="Center"
                                           IsHitTestVisible="False"/>
                                <TextBlock Text="or click to paste file path" 
                                           FontSize="12" 
                                           Foreground="{StaticResource TextMuted}"
                                           HorizontalAlignment="Center"
                                           Margin="0,4,0,0"
                                           IsHitTestVisible="False"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Load Folder Button -->
                        <Button x:Name="LoadFolderButton"
                                Click="LoadFolder_Click"
                                Style="{StaticResource SecondaryButton}"
                                Height="48"
                                Margin="0,0,0,16"
                                HorizontalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FolderOpen" 
                                                         Width="20" Height="20" 
                                                         VerticalAlignment="Center"
                                                         Margin="0,0,8,0"/>
                                <TextBlock Text="Load Folder of Logs" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Manual Token Section -->
                        <Expander Header="🔧 Advanced: Manual Token"
                                  Foreground="{StaticResource TextSecondary}"
                                  FontSize="13"
                                  HorizontalAlignment="Stretch">
                            <Border Background="{StaticResource BgSecondary}" 
                                    CornerRadius="8" 
                                    Padding="20"
                                    Margin="0,8,0,0"
                                    BorderBrush="{StaticResource BorderDefault}"
                                    BorderThickness="1">
                                <StackPanel>
                                    <TextBlock Text="For developers using Salesforce CLI or Workbench" 
                                               TextWrapping="Wrap"
                                               Foreground="{StaticResource TextMuted}"
                                               FontSize="12"
                                               Margin="0,0,0,16"/>
                                    
                                    <TextBlock Text="Instance URL" Foreground="{StaticResource TextPrimary}" FontSize="12" Margin="0,0,0,4"/>
                                    <TextBox x:Name="ManualInstanceUrl" 
                                             Background="{StaticResource BgTertiary}"
                                             Foreground="{StaticResource TextPrimary}"
                                             BorderBrush="{StaticResource BorderDefault}"
                                             Padding="12"
                                             FontSize="13"
                                             Margin="0,0,0,12"/>
                                    
                                    <TextBlock Text="Access Token" Foreground="{StaticResource TextPrimary}" FontSize="12" Margin="0,0,0,4"/>
                                    <TextBox x:Name="ManualAccessToken" 
                                             Background="{StaticResource BgTertiary}"
                                             Foreground="{StaticResource TextPrimary}"
                                             BorderBrush="{StaticResource BorderDefault}"
                                             Padding="12"
                                             FontSize="13"
                                             Margin="0,0,0,16"/>
                                    
                                    <Button Content="Connect"
                                            Click="ManualConnect_Click"
                                            Style="{StaticResource SecondaryButton}"
                                            Height="40"
                                            Padding="20,0"/>
                                </StackPanel>
                            </Border>
                        </Expander>
                    </StackPanel>
                    
                    <!-- Security Notice -->
                    <Border Background="#FFFFFF" Opacity="0.05" 
                            CornerRadius="12" Padding="20" Margin="0,40,0,0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ShieldLockOutline" 
                                                     Width="24" Height="24" 
                                                     Foreground="{StaticResource Success}" 
                                                     VerticalAlignment="Center"
                                                     Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Secure OAuth 2.0 Login" 
                                           FontSize="15" 
                                           FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimary}"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="No passwords stored • SSO &amp; MFA supported • Official Salesforce login" 
                                           FontSize="13" 
                                           Foreground="{StaticResource TextSecondary}"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
            
            <!-- Feature Cards - Responsive Wrap -->
            <ItemsControl Grid.Row="2">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.Items>
                    
                    <!-- Feature 1: Setup -->
                    <Border Width="280" Margin="8" CornerRadius="8" Padding="24"
                            BorderThickness="0,2,0,0" BorderBrush="{StaticResource AccentPrimary}">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="#16163A" Offset="0"/>
                                <GradientStop Color="#13131E" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect Color="#7C6AFF" Opacity="0.2" BlurRadius="20" ShadowDepth="0"/>
                        </Border.Effect>
                        <StackPanel>
                            <Border CornerRadius="12" Width="52" Height="52"
                                    HorizontalAlignment="Center" Margin="0,0,0,20">
                                <Border.Background>
                                    <RadialGradientBrush>
                                        <GradientStop Color="#3D2AAF" Offset="0"/>
                                        <GradientStop Color="#1A1260" Offset="1"/>
                                    </RadialGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect Color="#7C6AFF" Opacity="0.6" BlurRadius="12" ShadowDepth="0"/>
                                </Border.Effect>
                                <TextBlock Text="⚡" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Spin Your Web in 30 Seconds" 
                                       FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimary}"
                                       HorizontalAlignment="Center" Margin="0,0,0,12"/>
                            <TextBlock Text="Set up debug logging faster than a spider spins silk." 
                                       FontSize="15" Foreground="{StaticResource TextSecondary}"
                                       TextWrapping="Wrap" TextAlignment="Center" LineHeight="24"/>
                        </StackPanel>
                    </Border>
                
                <!-- Feature 2: Analyze -->
                <Border Width="280" Margin="8" CornerRadius="8" Padding="24"
                        BorderThickness="0,2,0,0" BorderBrush="#8B5CF6">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#1A1228" Offset="0"/>
                            <GradientStop Color="#13131E" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect Color="#8B5CF6" Opacity="0.2" BlurRadius="20" ShadowDepth="0"/>
                    </Border.Effect>
                    <StackPanel>
                        <Border CornerRadius="12" Width="52" Height="52"
                                HorizontalAlignment="Center" Margin="0,0,0,20">
                            <Border.Background>
                                <RadialGradientBrush>
                                    <GradientStop Color="#6D28D9" Offset="0"/>
                                    <GradientStop Color="#2D1260" Offset="1"/>
                                </RadialGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="#8B5CF6" Opacity="0.6" BlurRadius="12" ShadowDepth="0"/>
                            </Border.Effect>
                            <TextBlock Text="🔍" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Strike Fast, Kill Bugs Dead" 
                                   FontSize="20" FontWeight="SemiBold" 
                                   Foreground="{StaticResource TextPrimary}"
                                   HorizontalAlignment="Center" Margin="0,0,0,12"/>
                        <TextBlock Text="Pinpoint performance killers instantly. Like venom, but for code." 
                                   FontSize="15" Foreground="{StaticResource TextSecondary}"
                                   TextWrapping="Wrap" TextAlignment="Center" LineHeight="24"/>
                    </StackPanel>
                </Border>
                
                <!-- Feature 3: Plain English -->
                <Border Width="280" Margin="8" CornerRadius="8" Padding="24"
                        BorderThickness="0,2,0,0" BorderBrush="#89D185">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#112218" Offset="0"/>
                            <GradientStop Color="#13131E" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect Color="#89D185" Opacity="0.18" BlurRadius="20" ShadowDepth="0"/>
                    </Border.Effect>
                    <StackPanel>
                        <Border CornerRadius="12" Width="52" Height="52"
                                HorizontalAlignment="Center" Margin="0,0,0,20">
                            <Border.Background>
                                <RadialGradientBrush>
                                    <GradientStop Color="#16653E" Offset="0"/>
                                    <GradientStop Color="#0A2A1A" Offset="1"/>
                                </RadialGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="#89D185" Opacity="0.5" BlurRadius="12" ShadowDepth="0"/>
                            </Border.Effect>
                            <TextBlock Text="📚" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Every Bug Gets Caught"
                                   FontSize="20" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimary}"
                                   HorizontalAlignment="Center" Margin="0,0,0,12"
                                   TextWrapping="Wrap"/>
                        <TextBlock Text="Plain English summaries. No jargon. Bugs can't hide in complexity."
                                   FontSize="15" Foreground="{StaticResource TextSecondary}"
                                   TextWrapping="Wrap" TextAlignment="Center" LineHeight="24"/>
                    </StackPanel>
                </Border>

                <!-- Feature 4: Live Streaming -->
                <Border Width="280" Margin="8" CornerRadius="8" Padding="24"
                        BorderThickness="0,2,0,0" BorderBrush="#79B8FF">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#0E1E36" Offset="0"/>
                            <GradientStop Color="#13131E" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect Color="#79B8FF" Opacity="0.18" BlurRadius="20" ShadowDepth="0"/>
                    </Border.Effect>
                    <StackPanel>
                        <Border CornerRadius="12" Width="52" Height="52"
                                HorizontalAlignment="Center" Margin="0,0,0,20">
                            <Border.Background>
                                <RadialGradientBrush>
                                    <GradientStop Color="#1A4A7A" Offset="0"/>
                                    <GradientStop Color="#0A1E3A" Offset="1"/>
                                </RadialGradientBrush>
                            </Border.Background>
                            <Border.Effect>
                                <DropShadowEffect Color="#79B8FF" Opacity="0.5" BlurRadius="12" ShadowDepth="0"/>
                            </Border.Effect>
                            <TextBlock Text="📡" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Watch Logs Live"
                                   FontSize="20" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimary}"
                                   HorizontalAlignment="Center" Margin="0,0,0,12"
                                   TextWrapping="Wrap"/>
                        <TextBlock Text="Connect to your org and watch debug logs appear in real-time as you click through Salesforce. Great for actively hunting a bug."
                                   FontSize="15" Foreground="{StaticResource TextSecondary}"
                                   TextWrapping="Wrap" TextAlignment="Center" LineHeight="24"/>
                    </StackPanel>
                </Border>
                
                </ItemsControl.Items>
            </ItemsControl>
            </Grid>
        </ScrollViewer>
        
        <!-- Recent Connections (Hidden until needed, positioned top-right) -->
        <Border x:Name="RecentConnectionsPanel" 
                Visibility="Collapsed"
                Style="{StaticResource GlassCard}"
                MaxWidth="360"
                Padding="24"
                VerticalAlignment="Top"
                HorizontalAlignment="Right"
                Margin="64,64,64,0">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                    <materialDesign:PackIcon Kind="History" 
                                           Width="20" Height="20" 
                                           Foreground="{StaticResource AccentPrimary}"
                                           VerticalAlignment="Center"
                                           Margin="0,0,8,0"/>
                    <TextBlock Text="Recent Connections" 
                               FontSize="16" 
                               FontWeight="SemiBold" 
                               Foreground="{StaticResource TextPrimary}"/>
                </StackPanel>
                
                <ItemsControl x:Name="RecentConnectionsList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Click="ReconnectButton_Click"
                                    Tag="{Binding}"
                                    Style="{StaticResource SecondaryButton}"
                                    HorizontalContentAlignment="Stretch"
                                    Margin="0,0,0,8"
                                    Height="Auto"
                                    Padding="16,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <materialDesign:PackIcon Grid.Column="0"
                                                           Kind="{Binding Icon}" 
                                                           Width="20" 
                                                           Height="20" 
                                                           VerticalAlignment="Center"
                                                           Foreground="{StaticResource AccentPrimary}"
                                                           Margin="0,0,12,0"/>
                                    
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left">
                                        <TextBlock Text="{Binding OrgName}" 
                                                 FontSize="14" 
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"/>
                                        <TextBlock Text="{Binding LastUsed}" 
                                                 FontSize="11" 
                                                 Foreground="{StaticResource TextSecondary}"
                                                 Margin="0,2,0,0"/>
                                    </StackPanel>
                                </Grid>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                
                <TextBlock x:Name="NoRecentConnectionsText"
                           Text="No recent connections yet"
                           Foreground="{StaticResource TextMuted}"
                           FontSize="13"
                           HorizontalAlignment="Center"
                           Margin="0,8"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
