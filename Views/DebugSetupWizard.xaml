<Window x:Class="SalesforceDebugAnalyzer.Views.DebugSetupWizard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Debug Logging Setup Wizard" 
        Height="700" 
        Width="900"
        WindowStartupLocation="CenterOwner"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{materialDesign:MaterialDesignFont}">
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Wizard Steps Sidebar -->
        <Border Grid.Column="0" Background="{DynamicResource PrimaryHueDarkBrush}" Padding="24">
            <StackPanel>
                <TextBlock Text="Setup Steps" FontSize="20" FontWeight="Bold" Foreground="White" Margin="0,0,0,24"/>
                
                <!-- Step 1 -->
                <Border x:Name="Step1Border" Background="#2196F3" Padding="16" CornerRadius="4" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <materialDesign:PackIcon Kind="Numeric1Circle" Foreground="White" Margin="0,0,8,0"/>
                            <TextBlock Text="Who to Debug" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="Choose which user" Foreground="#E3F2FD" FontSize="11"/>
                    </StackPanel>
                </Border>

                <!-- Step 2 -->
                <Border x:Name="Step2Border" Background="Transparent" BorderBrush="White" BorderThickness="1" Padding="16" CornerRadius="4" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <materialDesign:PackIcon Kind="Numeric2Circle" Foreground="White" Margin="0,0,8,0"/>
                            <TextBlock Text="Detail Level" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="How much to log" Foreground="#E3F2FD" FontSize="11"/>
                    </StackPanel>
                </Border>

                <!-- Step 3 -->
                <Border x:Name="Step3Border" Background="Transparent" BorderBrush="White" BorderThickness="1" Padding="16" CornerRadius="4" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <materialDesign:PackIcon Kind="Numeric3Circle" Foreground="White" Margin="0,0,8,0"/>
                            <TextBlock Text="Duration" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="How long to log" Foreground="#E3F2FD" FontSize="11"/>
                    </StackPanel>
                </Border>

                <!-- Step 4 -->
                <Border x:Name="Step4Border" Background="Transparent" BorderBrush="White" BorderThickness="1" Padding="16" CornerRadius="4">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <materialDesign:PackIcon Kind="Numeric4Circle" Foreground="White" Margin="0,0,8,0"/>
                            <TextBlock Text="Enable &amp; Download" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="Start logging" Foreground="#E3F2FD" FontSize="11"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="32">
                <!-- Step 1: Choose User -->
                <StackPanel x:Name="Step1Panel">
                    <TextBlock Text="Step 1: Who Do You Want to Debug?" FontSize="24" FontWeight="Bold" Margin="0,0,0,16"/>
                    
                    <materialDesign:Card Padding="24" Margin="0,0,0,16" Background="#E3F2FD">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <materialDesign:PackIcon Kind="InformationOutline" Width="20" Height="20" Margin="0,0,8,0"/>
                                <TextBlock Text="What is debug logging?" FontWeight="SemiBold"/>
                            </StackPanel>
                            <TextBlock TextWrapping="Wrap">
                                Debug logging records everything that happens when someone uses Salesforce - like clicking buttons, saving records, or running workflows.
                                This helps you understand what your code is doing and find problems.
                            </TextBlock>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Padding="24" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="Select a user to enable debug logging for:" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,16"/>
                            
                            <!-- Current User Option -->
                            <RadioButton x:Name="CurrentUserRadio" GroupName="UserSelection" IsChecked="True" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="Myself (Current User)" FontWeight="SemiBold" FontSize="15"/>
                                    <TextBlock x:Name="CurrentUserInfo" 
                                               Text="Loading..." 
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                                               Margin="0,4,0,0"/>
                                    <TextBlock Text="âœ“ Best for troubleshooting your own actions" 
                                               Foreground="Green" 
                                               FontSize="12"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </RadioButton>

                            <!-- Another User Option -->
                            <RadioButton x:Name="AnotherUserRadio" GroupName="UserSelection" Margin="0,0,0,8">
                                <StackPanel>
                                    <TextBlock Text="Another User" FontWeight="SemiBold" FontSize="15"/>
                                    <TextBlock Text="Debug someone else's actions (requires their User ID)" 
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </RadioButton>

                            <!-- User ID Input (shown when AnotherUserRadio is checked) -->
                            <StackPanel x:Name="UserIdPanel" Visibility="Collapsed" Margin="32,8,0,0">
                                <TextBlock Text="User ID:" Margin="0,0,0,4"/>
                                <TextBox x:Name="UserIdTextBox" 
                                         materialDesign:HintAssist.Hint="005XXXXXXXXXXXXXXX (18-character ID)"
                                         Margin="0,0,0,8"/>
                                <TextBlock Text="ðŸ’¡ Tip: Find this in Setup > Users > Click on user > View their User ID" 
                                           FontSize="12"
                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                           TextWrapping="Wrap"/>
                            </StackPanel>

                            <Button Content="Next: Choose Detail Level â†’" 
                                    Style="{StaticResource MaterialDesignRaisedButton}"
                                    HorizontalAlignment="Right"
                                    Margin="0,24,0,0"
                                    Click="NextToStep2_Click"/>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!-- Step 2: Debug Level -->
                <StackPanel x:Name="Step2Panel" Visibility="Collapsed">
                    <TextBlock Text="Step 2: How Much Detail Do You Need?" FontSize="24" FontWeight="Bold" Margin="0,0,0,16"/>
                    
                    <materialDesign:Card Padding="24" Margin="0,0,0,16" Background="#FFF3E0">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <materialDesign:PackIcon Kind="Alert" Width="20" Height="20" Margin="0,0,8,0"/>
                                <TextBlock Text="Why does this matter?" FontWeight="SemiBold"/>
                            </StackPanel>
                            <TextBlock TextWrapping="Wrap">
                                More detail = bigger log files. Logs are limited to 20MB, so too much detail might cause important information to be cut off.
                                Start with "Standard" for most troubleshooting.
                            </TextBlock>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Padding="24" Margin="0,0,0,24">
                        <StackPanel>
                            <!-- Preset Options -->
                            <StackPanel x:Name="PresetLevelsPanel">
                                <RadioButton x:Name="StandardLevelRadio" GroupName="DebugLevel" IsChecked="True" Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="âœ“ Standard (Recommended)" FontWeight="SemiBold" FontSize="16"/>
                                        <TextBlock Text="Good balance of detail. Shows errors, warnings, and important events." 
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton x:Name="DetailedLevelRadio" GroupName="DebugLevel" Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="Detailed" FontWeight="SemiBold" FontSize="16"/>
                                        <TextBlock Text="More information including database queries and code execution flow." 
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton x:Name="CustomLevelRadio" GroupName="DebugLevel">
                                    <StackPanel>
                                        <TextBlock Text="Custom (Advanced)" FontWeight="SemiBold" FontSize="16"/>
                                        <TextBlock Text="Choose an existing debug level or create your own" 
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </RadioButton>
                            </StackPanel>

                            <!-- Custom Debug Level Selection -->
                            <StackPanel x:Name="CustomLevelPanel" Visibility="Collapsed" Margin="0,16,0,0">
                                <ComboBox x:Name="DebugLevelComboBox" 
                                          DisplayMemberPath="MasterLabel"
                                          materialDesign:HintAssist.Hint="Select existing debug level"
                                          Margin="0,0,0,8"/>
                                <Button Content="Create New Debug Level" 
                                        Style="{StaticResource MaterialDesignOutlinedButton}"
                                        Click="CreateDebugLevel_Click"
                                        HorizontalAlignment="Left"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,24,0,0">
                                <Button Content="â† Back" 
                                        Style="{StaticResource MaterialDesignOutlinedButton}"
                                        Click="BackToStep1_Click"
                                        Margin="0,0,8,0"/>
                                <Button Content="Next: Set Duration â†’" 
                                        Style="{StaticResource MaterialDesignRaisedButton}"
                                        Click="NextToStep3_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!-- Step 3: Duration -->
                <StackPanel x:Name="Step3Panel" Visibility="Collapsed">
                    <TextBlock Text="Step 3: How Long Should Logging Stay Active?" FontSize="24" FontWeight="Bold" Margin="0,0,0,16"/>
                    
                    <materialDesign:Card Padding="24" Margin="0,0,0,16" Background="#E8F5E9">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <materialDesign:PackIcon Kind="ClockOutline" Width="20" Height="20" Margin="0,0,8,0"/>
                                <TextBlock Text="Why set a time limit?" FontWeight="SemiBold"/>
                            </StackPanel>
                            <TextBlock TextWrapping="Wrap">
                                Debug logs take up space and can slow things down slightly. After the time expires, logging automatically stops.
                                You can always turn it back on later!
                            </TextBlock>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Padding="24" Margin="0,0,0,24">
                        <StackPanel>
                            <Slider x:Name="DurationSlider" 
                                    Minimum="1" 
                                    Maximum="24" 
                                    Value="2" 
                                    TickFrequency="1" 
                                    IsSnapToTickEnabled="True"
                                    Margin="0,0,0,16"
                                    ValueChanged="DurationSlider_ValueChanged"/>
                            
                            <TextBlock x:Name="DurationDisplay" 
                                       Text="Expires in 2 hours" 
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,8"/>
                            
                            <TextBlock x:Name="DurationRecommendation" 
                                       Text="âœ“ Good for quick testing (2-4 hours recommended)" 
                                       FontSize="13"
                                       Foreground="Green"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,24"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button Content="â† Back" 
                                        Style="{StaticResource MaterialDesignOutlinedButton}"
                                        Click="BackToStep2_Click"
                                        Margin="0,0,8,0"/>
                                <Button Content="Next: Enable Logging â†’" 
                                        Style="{StaticResource MaterialDesignRaisedButton}"
                                        Click="NextToStep4_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!-- Step 4: Enable & Download -->
                <StackPanel x:Name="Step4Panel" Visibility="Collapsed">
                    <TextBlock Text="Step 4: Ready to Enable Debug Logging!" FontSize="24" FontWeight="Bold" Margin="0,0,0,16"/>
                    
                    <materialDesign:Card Padding="24" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Summary:" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="User:" FontWeight="SemiBold" Margin="0,4"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="SummaryUser" Text="Current User" Margin="8,4"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Detail Level:" FontWeight="SemiBold" Margin="0,4"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="SummaryLevel" Text="Standard" Margin="8,4"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Duration:" FontWeight="SemiBold" Margin="0,4"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="SummaryDuration" Text="2 hours" Margin="8,4"/>
                            </Grid>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Padding="24" Margin="0,0,0,16" Background="#F3E5F5">
                        <StackPanel>
                            <TextBlock Text="What Happens Next?" FontWeight="SemiBold" Margin="0,0,0,12"/>
                            <StackPanel Margin="16,0,0,0">
                                <TextBlock Text="1. We'll enable debug logging with your settings" Margin="0,4"/>
                                <TextBlock Text="2. Have the user perform the action you want to troubleshoot" Margin="0,4"/>
                                <TextBlock Text="3. Come back here to download and analyze the logs" Margin="0,4"/>
                                <TextBlock Text="4. Get plain-English explanations of what happened!" Margin="0,4" FontWeight="SemiBold"/>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Padding="24">
                        <StackPanel>
                            <Button x:Name="EnableButton" 
                                    Content="ðŸš€ Enable Debug Logging" 
                                    Style="{StaticResource MaterialDesignRaisedButton}"
                                    FontSize="16"
                                    Height="48"
                                    Click="EnableLogging_Click"
                                    Margin="0,0,0,16"/>

                            <ProgressBar x:Name="EnableProgressBar" 
                                         IsIndeterminate="True" 
                                         Visibility="Collapsed"
                                         Margin="0,0,0,8"/>
                            
                            <TextBlock x:Name="StatusText" 
                                       Text="" 
                                       TextAlignment="Center"
                                       Visibility="Collapsed"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,16,0,0">
                                <Button Content="â† Back" 
                                        Style="{StaticResource MaterialDesignOutlinedButton}"
                                        Click="BackToStep3_Click"
                                        Margin="0,0,8,0"/>
                                <Button Content="View Active Logs" 
                                        x:Name="ViewLogsButton"
                                        Style="{StaticResource MaterialDesignRaisedButton}"
                                        Visibility="Collapsed"
                                        Click="ViewLogs_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
